CREATE USER 'geoapi'@'localhost' IDENTIFIED BY 'ga2010';

DROP DATABASE geoapi;

CREATE DATABASE geoapi;

GRANT ALL PRIVILEGES
ON geoapi.*
TO 'geoapi'@'localhost'
WITH GRANT OPTION;

GRANT ALL PRIVILEGES
ON geoapi.*
TO 'geoapi'@'%'
WITH GRANT OPTION;

USE geoapi;

CREATE TABLE apiuser (
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	apikey VARCHAR(256),
	name VARCHAR(256),
	description VARCHAR(1024),
	UNIQUE (apikey)
) ENGINE=INNODB;

CREATE TABLE metric (
	command VARCHAR(2056),
	date VARCHAR(256),
	host VARCHAR(256),
	userid INT,
	FOREIGN KEY (userid) references apiuser(id) ON DELETE CASCADE
) ENGINE=INNODB;

CREATE TABLE senate (
	district VARCHAR(50),
	districturl VARCHAR(256),
	PRIMARY KEY(district)
) ENGINE=INNODB;

CREATE TABLE senator (
	name VARCHAR(256),
	contact VARCHAR(256),
	url VARCHAR(256),
	imageurl VARCHAR(256),
	district VARCHAR(50),
	FOREIGN KEY (district) REFERENCES senate(district) ON DELETE CASCADE,
	PRIMARY KEY(contact)
) ENGINE=INNODB;

CREATE TABLE social (
	facebook VARCHAR(1024),
	twitter VARCHAR(1024),
	youtube VARCHAR(1024),
	flickr VARCHAR(1024),
	rss VARCHAR(1024),
	contact VARCHAR(256),
	FOREIGN KEY (contact) REFERENCES senator(contact) ON DELETE CASCADE
) ENGINE=INNODB;

CREATE TABLE office (
	id INT NOT NULL AUTO_INCREMENT,
	street VARCHAR(1024),
	city VARCHAR(256),
	state VARCHAR(256),
	zip VARCHAR(32),
	lat DOUBLE PRECISION(15,12),
	lon DOUBLE PRECISION(15,12),
	officeName VARCHAR(256),
	phone VARCHAR(256),
	fax VARCHAR(256),
	contact VARCHAR(256),
	FOREIGN KEY (contact) REFERENCES senator(contact) ON DELETE CASCADE,
	PRIMARY KEY(id)
) ENGINE=INNODB;


CREATE TABLE assembly (
	district VARCHAR(50),
	PRIMARY KEY(district)
) ENGINE=INNODB;

CREATE TABLE congressional (
	district VARCHAR(50),
	PRIMARY KEY(district)
) ENGINE=INNODB;

create table member (
	name VARCHAR(256),
	url VARCHAR(256),
	district VARCHAR(50)
) ENGINE=INNODB;

create table oldaiscount (
	ip VARCHAR(128)
) ENGINE=INNODB;